const A=e;function d(){const Z=['gdIor','4991202gWSPwk','installing','split','image/webp','result','application/octet-stream','276tuMvnv','toISOString','toLowerCase','base64','saveGm','updateLastPlayed','files','iqzpa','getMime','trace','includes','pop','gm\x20loader\x20db','xml','objectStoreNames','/loadersw.js','none','cleanupOld','error','blob','text/html','image/png','8lPCbLh','waiting','application/vnd.ms-fontobject','125475yUZrku','DRKXl','onupgradeneeded','href','gm-','image/jpeg','10gcsKZC','1298155PDjAqw','extractZip','FQhoK','1397acmnCJ','register','gfRVQ','8259687ZzvCJF','GuMnb','lHHRA','has','video/webm','getGm','application/xml','isArray','getTime','serviceWorker','KpaxZ','contains','onerror','readonly','8SDCIUa','CnElG','audio/mpeg','async','application/json','loadAsync','image/gif','readwrite','166038chPuFE','initDB','./loadersw.js','lastPlayed','active','prototype','__proto__','SkZlb','target','extractMultipleZips','video/ogg','now','SKIP_WAITING','controllerchange','put','text/markdown','get','37571220TtZowo','addEventListener','onsuccess','53660nKIWPb','value','bind','hIxvu','image/avif','continue','regSW','MCIPS','dbAction','JOdJM'];d=function(){return Z;};return d();}(function(h,i){const y=e,j=h();while(!![]){try{const k=-parseInt(y(0x152))/0x1*(parseInt(y(0x16f))/0x2)+-parseInt(y(0x12d))/0x3+-parseInt(y(0x167))/0x4*(parseInt(y(0x153))/0x5)+-parseInt(y(0x133))/0x6*(parseInt(y(0x14c))/0x7)+-parseInt(y(0x149))/0x8*(-parseInt(y(0x159))/0x9)+-parseInt(y(0x183))/0xa*(-parseInt(y(0x156))/0xb)+parseInt(y(0x180))/0xc;if(k===i)break;else j['push'](j['shift']());}catch(n){j['push'](j['shift']());}}}(d,0xd9e08));function e(a,b){a=a-0x126;const c=d();let f=c[a];return f;}const b=(function(){let h=!![];return function(i,j){const k=h?function(){if(j){const n=j['apply'](i,arguments);return j=null,n;}}:function(){};return h=![],k;};}()),a=b(this,function(){const z=e,h={'CnElG':'return\x20(function()\x20','ltLRY':'log','eQGYJ':function(n,o){return n<o;}};let i;try{const n=Function(h[z(0x168)]+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');i=n();}catch(o){i=window;}const j=i['console']=i['console']||{},k=[h['ltLRY'],'warn','info','error','exception','table',z(0x13c)];for(let q=0x0;h['eQGYJ'](q,k['length']);q++){const r=b['constructor'][z(0x174)]['bind'](b),s=k[q],t=j[s]||r;r[z(0x175)]=b[z(0x185)](b),r['toString']=t['toString']['bind'](t),j[s]=r;}});a();import{ag as f}from'./vendor-modules.kyFu_h-i.js';const p=A(0x13f),g=0x1,c='gms',m=new Set(['html','htm','css','js','mjs','json',A(0x140),'txt','md','csv','svg']);class w{constructor(){this['db']=null;}async['initDB'](){return this['db']?this['db']:new Promise((h,j)=>{const B=e,k=indexedDB['open'](p,g);k['onerror']=()=>j(k[B(0x145)]),k['onsuccess']=()=>{const C=B;this['db']=k[C(0x131)],h(this['db']);},k[B(0x14e)]=n=>{const D=B,o=n['target']['result'];o[D(0x141)][D(0x164)](c)||o['createObjectStore'](c,{'keyPath':'id'});};});}async['dbAction'](h,j){const k=await this['initDB']();return new Promise((n,q)=>{const s=k['transaction']([c],h)['objectStore'](c);j(s,n,q);});}async['saveGm'](h,j){const E=A,k={'gdIor':'readwrite'};return this['dbAction'](k[E(0x12c)],(n,o,q)=>{const F=E,u=n[F(0x17d)]({'id':h,'name':h,'files':j,'uploadDate':new Date()[F(0x134)](),'lastPlayed':new Date()[F(0x134)]()});u['onsuccess']=()=>o(),u['onerror']=()=>q(u[F(0x145)]);});}async[A(0x138)](h){const G=A;return this[G(0x12a)](G(0x16e),(j,k,n)=>{const H=G,o=j[H(0x17f)](h);o['onsuccess']=()=>{const I=H,q=o['result'];if(q){q[I(0x172)]=new Date()['toISOString']();const u=j[I(0x17d)](q);u[I(0x182)]=()=>k(),u['onerror']=()=>n(u[I(0x145)]);}else k();},o[H(0x165)]=()=>n(o['error']);});}async[A(0x144)](){const h={'hIxvu':function(i,j){return i-j;},'JOdJM':function(i,j){return i*j;}};return this['dbAction']('readwrite',(j,k,n)=>{const J=e,o=j['openCursor'](),q=h[J(0x186)](Date[J(0x17a)](),h[J(0x12b)](0x10e0*0x3c,0x3e8));o['onsuccess']=u=>{const K=J,v=u[K(0x177)][K(0x131)];if(v){const x=v[K(0x184)];new Date(x[K(0x172)]||x['uploadDate'])[K(0x161)]()<q&&v['delete'](),v[K(0x127)]();}else k();},o[J(0x165)]=()=>n(o['error']);});}async[A(0x15e)](h){const L=A;return this['dbAction'](L(0x166),(j,k,n)=>{const M=L,o=j[M(0x17f)](h);o[M(0x182)]=()=>k(o['result']),o['onerror']=()=>n(o[M(0x145)]);});}async['getAllGms'](){const N=A;return this[N(0x12a)]('readonly',(h,j,k)=>{const O=N,n=h['getAll']();n[O(0x182)]=()=>j(n[O(0x131)]||[]),n['onerror']=()=>k(n['error']);});}['isBinary'](h){const P=A,j=h[P(0x12f)]('.')[P(0x13e)]()['toLowerCase']();return!m[P(0x15c)](j);}async['extractZip'](h){const Q=A,j=await(await fetch(h))[Q(0x146)](),k=await new f()[Q(0x16c)](j),q={};for(const [t,u]of Object['entries'](k[Q(0x139)]))if(!u['dir']){const v=this['isBinary'](t);q[t]={'content':await u[Q(0x16a)](v?Q(0x136):'string'),'mime':this['getMime'](t),'binary':v};}return q;}async['extractMultipleZips'](h){const R=A,j={};for(const k of h){const n=await this[R(0x154)](k);Object['assign'](j,n);}return j;}[A(0x13b)](h){const S=A,j={'qtQlR':S(0x147),'gfRVQ':'application/javascript','GuMnb':S(0x15f),'Sggwm':'text/csv','KpaxZ':'font/ttf','iqzpa':'font/otf','kDWDf':S(0x169),'NcGrB':'audio/mp4','SkZlb':'application/gzip','DRKXl':'application/octet-stream'},k=h[S(0x12f)]('.')['pop']()[S(0x135)]();return{'html':j['qtQlR'],'htm':S(0x147),'css':'text/css','js':j[S(0x158)],'mjs':'application/javascript','json':S(0x16b),'xml':j[S(0x15a)],'txt':'text/plain','md':S(0x17e),'csv':j['Sggwm'],'png':S(0x148),'jpg':'image/jpeg','jpeg':S(0x151),'gif':S(0x16d),'svg':'image/svg+xml','ico':'image/x-icon','webp':S(0x130),'bmp':'image/bmp','avif':S(0x126),'woff':'font/woff','woff2':'font/woff2','ttf':j[S(0x163)],'otf':j[S(0x13a)],'eot':S(0x14b),'mp3':j['kDWDf'],'wav':'audio/wav','ogg':'audio/ogg','m4a':j['NcGrB'],'aac':'audio/aac','mp4':'video/mp4','webm':S(0x15d),'ogv':S(0x179),'wasm':'application/wasm','zip':'application/zip','gz':j[S(0x176)],'pdf':'application/pdf','data':j[S(0x14d)],'unityweb':S(0x132),'bundle':j['DRKXl'],'bin':j[S(0x14d)],'dat':j['DRKXl'],'mem':S(0x132),'asset':'application/octet-stream','resource':S(0x132)}[k]||'application/octet-stream';}async[A(0x128)](){const T=A,h={'FQhoK':function(j){return j();},'MCIPS':'from\x20local\x20gm\x20loader'};if('serviceWorker'in navigator)try{let j=(await navigator[T(0x162)]['getRegistrations']())['find'](k=>k['active']?.['scriptURL'][T(0x13d)](T(0x142)));if(!j){const k=await navigator['serviceWorker'][T(0x157)](new URL(T(0x171),location['href'])['href'],{'scope':new URL('/',location['origin'])['href'],'updateViaCache':T(0x143)});return await navigator[T(0x162)]['ready'],navigator[T(0x162)]['controller']||await new Promise(n=>{const U=T;navigator[U(0x162)][U(0x181)](U(0x17c),n,{'once':!0x0});}),k;}if((j[T(0x12e)]||j[T(0x14a)])&&await new Promise(n=>{const W=T,o={'scJFJ':function(r){const V=e;return h[V(0x155)](r);}},q=j[W(0x12e)]||j['waiting'];q['addEventListener']('statechange',()=>{q['state']==='activated'&&o['scJFJ'](n);});}),!navigator['serviceWorker']['controller']){const n=(await navigator['serviceWorker']['ready'])[T(0x173)];n&&(n['postMessage']({'type':T(0x17b)}),await new Promise(o=>{const X=T;navigator['serviceWorker']['addEventListener'](X(0x17c),o,{'once':!0x0});}));}return j;}catch(o){console[T(0x145)](h[T(0x129)],o);}}async['load'](h,j){const Y=A,k={'lHHRA':'.zip','dUMMP':function(u,v){return u(v);}};await this[Y(0x128)](),await this[Y(0x170)]();const n=Array[Y(0x160)](h),q=(n?h[0x0]:h)[Y(0x12f)]('/')[Y(0x13e)]()['replace'](k[Y(0x15b)],'')||Y(0x150)+Date[Y(0x17a)]();if(await this[Y(0x15e)](q))return await this[Y(0x138)](q),{'url':new URL('./game/'+q+'/index.html',location[Y(0x14f)])['href'],'cached':!0x0};j&&j(!0x0);const s=n?await this[Y(0x178)](h):await this['extractZip'](h);return await this[Y(0x137)](q,s),j&&k['dUMMP'](j,!0x1),{'url':new URL('./game/'+q+'/index.html',location[Y(0x14f)])['href'],'cached':!0x1};}}export{w as default};