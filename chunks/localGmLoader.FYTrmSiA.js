const B=e;(function(h,i){const y=e,j=h();while(!![]){try{const k=-parseInt(y(0x1b5))/0x1*(-parseInt(y(0x16c))/0x2)+-parseInt(y(0x193))/0x3+-parseInt(y(0x19d))/0x4*(parseInt(y(0x1a6))/0x5)+-parseInt(y(0x1c8))/0x6+-parseInt(y(0x1a2))/0x7*(parseInt(y(0x1b2))/0x8)+-parseInt(y(0x1b0))/0x9*(parseInt(y(0x1c5))/0xa)+parseInt(y(0x172))/0xb;if(k===i)break;else j['push'](j['shift']());}catch(n){j['push'](j['shift']());}}}(d,0xed90e));const b=(function(){let h=!![];return function(i,j){const k=h?function(){if(j){const n=j['apply'](i,arguments);return j=null,n;}}:function(){};return h=![],k;};}()),a=b(this,function(){const z=e,h={'uISUS':z(0x16a),'PTrmh':'info','QWGOe':'exception','vLHvn':function(o,q){return o<q;}},i=function(){const A=z;let o;try{o=Function(h[A(0x19f)]+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(q){o=window;}return o;},j=i(),k=j[z(0x18c)]=j[z(0x18c)]||{},n=['log','warn',h['PTrmh'],'error',h['QWGOe'],'table',z(0x1a1)];for(let o=0x0;h[z(0x1a8)](o,n[z(0x1ab)]);o++){const q=b['constructor']['prototype']['bind'](b),r=n[o],s=k[r]||q;q['__proto__']=b['bind'](b),q['toString']=s[z(0x175)][z(0x1aa)](s),k[r]=q;}});a();import{ag as f}from'./vendor-modules.kyFu_h-i.js';const p=B(0x179),g=0x1,c=B(0x1c0),m=new Set(['html','htm','css','js','mjs',B(0x19e),'xml',B(0x1be),'md','csv','svg']);function d(){const a0=['txt','audio/ogg','gms','register','getAllGms','image/png','serviceWorker','570SJKmIk','application/vnd.ms-fontobject','href','9523032LydtSi','application/zip','active','AFGPN','getRegistrations','now','blob','get','origin','getMime','bbhmq','return\x20(function()\x20','updateLastPlayed','22YNNiOo','readonly','target','./loadersw.js','pop','font/woff2','94380363BzVROy','audio/wav','result','toString','onerror','error','controllerchange','gm\x20loader\x20db','replace','addEventListener','includes','getAll','uploadDate','ECXfA','text/css','application/xml','scriptURL','RjVcq','SKIP_WAITING','controller','load','put','zMtyB','application/octet-stream','tmxrr','MmexI','console','extractMultipleZips','application/json','text/html','initDB','video/mp4','extractZip','5059038bxGdmZ','split','openCursor','dogTI','haQMQ','onsuccess','isBinary','getTime','lastPlayed','fzIXW','300eYwZxg','json','uISUS','regSW','trace','1585073sQblEB','application/javascript','ready','yJQeM','108305edCoBn','video/ogg','vLHvn','dbAction','bind','length','dir','createObjectStore','toLowerCase','/loadersw.js','298323PMyROw','./game/','48LRcvQC','state','image/x-icon','49013WQkyxT','has','string','base64','delete','saveGm','installing','onupgradeneeded','entries'];d=function(){return a0;};return d();}function e(a,b){a=a-0x166;const c=d();let f=c[a];return f;}class w{constructor(){this['db']=null;}async[B(0x190)](){const h={'yJQeM':function(i,j){return i(j);}};return this['db']?this['db']:new Promise((j,k)=>{const C=e,n=indexedDB['open'](p,g);n[C(0x176)]=()=>k(n[C(0x177)]),n[C(0x198)]=()=>{const D=C;this['db']=n['result'],h[D(0x1a5)](j,this['db']);},n[C(0x1bc)]=o=>{const E=C,q=o[E(0x16e)][E(0x174)];q['objectStoreNames']['contains'](c)||q[E(0x1ad)](c,{'keyPath':'id'});};});}async['dbAction'](h,j){const k={'bIDwy':function(o,q,r,s){return o(q,r,s);}},n=await this['initDB']();return new Promise((q,s)=>{const u=n['transaction']([c],h)['objectStore'](c);k['bIDwy'](j,u,q,s);});}async['saveGm'](h,j){return this['dbAction']('readwrite',(k,n,o)=>{const F=e,q=k['put']({'id':h,'name':h,'files':j,'uploadDate':new Date()['toISOString'](),'lastPlayed':new Date()['toISOString']()});q[F(0x198)]=()=>n(),q[F(0x176)]=()=>o(q['error']);});}async['updateLastPlayed'](h){const G=B,j={'RbFMt':'readwrite'};return this[G(0x1a9)](j['RbFMt'],(k,n,o)=>{const H=G,q=k[H(0x166)](h);q[H(0x198)]=()=>{const I=H,u=q[I(0x174)];if(u){u['lastPlayed']=new Date()['toISOString']();const v=k[I(0x187)](u);v[I(0x198)]=()=>n(),v['onerror']=()=>o(v['error']);}else n();},q['onerror']=()=>o(q[H(0x177)]);});}async['cleanupOld'](){const J=B,h={'zMtyB':function(i){return i();},'SYdXR':'readwrite'};return this[J(0x1a9)](h['SYdXR'],(j,k,n)=>{const L=J,o={'uWzUB':function(u,v){return u<v;},'RjVcq':function(u){const K=e;return h[K(0x188)](u);}},q=j[L(0x195)](),s=Date[L(0x1cd)]()-0x10e0*0x3c*0x3e8;q['onsuccess']=u=>{const M=L,v=u['target'][M(0x174)];if(v){const x=v['value'];o['uWzUB'](new Date(x[M(0x19b)]||x[M(0x17e)])[M(0x19a)](),s)&&v[M(0x1b9)](),v['continue']();}else o[M(0x183)](k);},q[L(0x176)]=()=>n(q[L(0x177)]);});}async['getGm'](h){const N=B,j={'fzIXW':N(0x16d)};return this[N(0x1a9)](j[N(0x19c)],(k,n,o)=>{const O=N,q=k[O(0x166)](h);q['onsuccess']=()=>n(q[O(0x174)]),q[O(0x176)]=()=>o(q['error']);});}async[B(0x1c2)](){const h={'RNhQE':'readonly'};return this['dbAction'](h['RNhQE'],(j,k,n)=>{const P=e,o=j[P(0x17d)]();o['onsuccess']=()=>k(o[P(0x174)]||[]),o[P(0x176)]=()=>n(o[P(0x177)]);});}[B(0x199)](h){const Q=B,j=h[Q(0x194)]('.')[Q(0x170)]()[Q(0x1ae)]();return!m[Q(0x1b6)](j);}async[B(0x192)](h){const R=B,j={'dogTI':R(0x1b8),'qAjtM':R(0x1b7)},k=await(await fetch(h))[R(0x1ce)](),q=await new f()['loadAsync'](k),t={};for(const [u,v]of Object[R(0x1bd)](q['files']))if(!v[R(0x1ac)]){const x=this['isBinary'](u);t[u]={'content':await v['async'](x?j[R(0x196)]:j['qAjtM']),'mime':this[R(0x168)](u),'binary':x};}return t;}async['extractMultipleZips'](h){const S=B,j={};for(const k of h){const n=await this[S(0x192)](k);Object['assign'](j,n);}return j;}[B(0x168)](h){const T=B,j={'haQMQ':T(0x18f),'idMLm':'text/plain','GZOeJ':'image/gif','bbhmq':T(0x1c6),'ECXfA':T(0x1bf),'WmJYe':'application/pdf','tmxrr':T(0x189)},k=h[T(0x194)]('.')['pop']()[T(0x1ae)]();return{'html':j[T(0x197)],'htm':'text/html','css':T(0x180),'js':'application/javascript','mjs':T(0x1a3),'json':T(0x18e),'xml':T(0x181),'txt':j['idMLm'],'md':'text/markdown','csv':'text/csv','png':T(0x1c3),'jpg':'image/jpeg','jpeg':'image/jpeg','gif':j['GZOeJ'],'svg':'image/svg+xml','ico':T(0x1b4),'webp':'image/webp','bmp':'image/bmp','avif':'image/avif','woff':'font/woff','woff2':T(0x171),'ttf':'font/ttf','otf':'font/otf','eot':j[T(0x169)],'mp3':'audio/mpeg','wav':T(0x173),'ogg':j[T(0x17f)],'m4a':'audio/mp4','aac':'audio/aac','mp4':T(0x191),'webm':'video/webm','ogv':T(0x1a7),'wasm':'application/wasm','zip':T(0x1c9),'gz':'application/gzip','pdf':j['WmJYe'],'data':'application/octet-stream','unityweb':j[T(0x18a)],'bundle':T(0x189),'bin':'application/octet-stream','dat':'application/octet-stream','mem':'application/octet-stream','asset':j[T(0x18a)],'resource':'application/octet-stream'}[k]||T(0x189);}async[B(0x1a0)](){const U=B,h={'AFGPN':'none','MmexI':'from\x20local\x20gm\x20loader'};if(U(0x1c4)in navigator)try{let j=(await navigator[U(0x1c4)][U(0x1cc)]())['find'](k=>k[U(0x1ca)]?.[U(0x182)][U(0x17c)](U(0x1af)));if(!j){const k=await navigator['serviceWorker'][U(0x1c1)](new URL(U(0x16f),location[U(0x1c7)])[U(0x1c7)],{'scope':new URL('/',location[U(0x167)])[U(0x1c7)],'updateViaCache':h[U(0x1cb)]});return await navigator['serviceWorker']['ready'],navigator['serviceWorker'][U(0x185)]||await new Promise(n=>{const V=U;navigator[V(0x1c4)][V(0x17b)](V(0x178),n,{'once':!0x0});}),k;}if((j[U(0x1bb)]||j['waiting'])&&await new Promise(n=>{const W=U,o={'wrzut':'activated','oHPSR':function(r){return r();}},q=j['installing']||j['waiting'];q[W(0x17b)]('statechange',()=>{const X=W;q[X(0x1b3)]===o['wrzut']&&o['oHPSR'](n);});}),!navigator[U(0x1c4)]['controller']){const n=(await navigator['serviceWorker'][U(0x1a4)])['active'];n&&(n['postMessage']({'type':U(0x184)}),await new Promise(o=>{const Y=U;navigator[Y(0x1c4)][Y(0x17b)]('controllerchange',o,{'once':!0x0});}));}return j;}catch(o){console['error'](h[U(0x18b)],o);}}async[B(0x186)](h,j){const Z=B,k={'FYzjZ':function(u,v){return u(v);}};await this[Z(0x1a0)](),await this[Z(0x190)]();const n=Array['isArray'](h),q=(n?h[0x0]:h)[Z(0x194)]('/')[Z(0x170)]()[Z(0x17a)]('.zip','')||'gm-'+Date['now']();if(await this['getGm'](q))return await this[Z(0x16b)](q),{'url':new URL(Z(0x1b1)+q+'/index.html',location['href'])['href'],'cached':!0x0};j&&k['FYzjZ'](j,!0x0);const s=n?await this[Z(0x18d)](h):await this['extractZip'](h);return await this[Z(0x1ba)](q,s),j&&j(!0x1),{'url':new URL(Z(0x1b1)+q+'/index.html',location[Z(0x1c7)])['href'],'cached':!0x1};}}export{w as default};