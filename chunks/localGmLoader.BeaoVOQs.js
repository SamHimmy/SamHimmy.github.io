const B=e;(function(h,i){const y=e,j=h();while(!![]){try{const k=parseInt(y(0xdf))/0x1+-parseInt(y(0xe5))/0x2+parseInt(y(0xe8))/0x3*(parseInt(y(0xfd))/0x4)+parseInt(y(0xf8))/0x5+-parseInt(y(0xe0))/0x6*(parseInt(y(0x135))/0x7)+-parseInt(y(0xf7))/0x8*(-parseInt(y(0xe7))/0x9)+parseInt(y(0x129))/0xa*(parseInt(y(0xf6))/0xb);if(k===i)break;else j['push'](j['shift']());}catch(n){j['push'](j['shift']());}}}(d,0x1ffd2));const b=(function(){let h=!![];return function(i,j){const k=h?function(){if(j){const n=j['apply'](i,arguments);return j=null,n;}}:function(){};return h=![],k;};}()),a=b(this,function(){const A=e,h={'tyTnz':function(o,q){return o(q);},'fXrwY':'warn','XfLzD':'error'},i=function(){const z=e;let o;try{o=h[z(0xe2)](Function,z(0x108)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(q){o=window;}return o;},j=i(),k=j['console']=j[A(0x13a)]||{},n=[A(0x13b),h['fXrwY'],'info',h['XfLzD'],A(0x123),'table','trace'];for(let o=0x0;o<n['length'];o++){const q=b['constructor'][A(0x13d)][A(0x141)](b),r=n[o],s=k[r]||q;q['__proto__']=b[A(0x141)](b),q[A(0x103)]=s['toString'][A(0x141)](s),k[r]=q;}});a();import{ag as f}from'./vendor-modules.kyFu_h-i.js';function d(){const Z=['error','getGm','scriptURL','waiting','NcFBZ','readwrite','lastPlayed','audio/wav','saveGm','afOxb','xml','gms','156365cqhIHS','4264WrZutx','198645GhUYQk','open','now','getAllGms','toISOString','4mlhBfz','image/svg+xml','extractZip','getRegistrations','application/javascript','put','toString','installing','getTime','Wjcfc','split','return\x20(function()\x20','loadAsync','image/webp','jpoIs','addEventListener','regSW','FgNPw','result','controller','onsuccess','dbAction','image/png','application/gzip','IWQHB','csv','UNTrN','iEwhM','video/ogg','find','load','Kqyni','getMime','font/woff2','/index.html','controllerchange','href','assign','exception','gm\x20loader\x20db','isBinary','base64','application/json','mjs','190ftTMht','isArray','onupgradeneeded','dir','json','hGlza','image/jpeg','extractMultipleZips','readonly','get','application/octet-stream','audio/mp4','367871vThLey','NneqH','text/csv','font/otf','entries','console','log','pop','prototype','files','BsyOt','gm-','bind','JIfEp','qvzTY','CiPkS','toLowerCase','continue','./game/','html','uploadDate','onerror','.zip','36390LhzIPX','12UacOIz','ready','tyTnz','serviceWorker','text/css','467512peobLi','contains','1359ESTEDg','129603qKcvvv','image/x-icon'];d=function(){return Z;};return d();}const p=B(0x124),g=0x1,c=B(0xf5),m=new Set([B(0xdb),'htm','css','js',B(0x128),B(0x12d),B(0xf4),'txt','md',B(0x116),'svg']);class w{constructor(){this['db']=null;}async['initDB'](){return this['db']?this['db']:new Promise((h,j)=>{const C=e,k=indexedDB[C(0xf9)](p,g);k['onerror']=()=>j(k[C(0xea)]),k['onsuccess']=()=>{const D=C;this['db']=k[D(0x10f)],h(this['db']);},k[C(0x12b)]=n=>{const E=C,o=n['target']['result'];o['objectStoreNames'][E(0xe6)](c)||o['createObjectStore'](c,{'keyPath':'id'});};});}async[B(0x112)](h,j){const k=await this['initDB']();return new Promise((n,q)=>{const s=k['transaction']([c],h)['objectStore'](c);j(s,n,q);});}async['saveGm'](h,j){return this['dbAction']('readwrite',(k,n,o)=>{const F=e,q=k['put']({'id':h,'name':h,'files':j,'uploadDate':new Date()[F(0xfc)](),'lastPlayed':new Date()[F(0xfc)]()});q['onsuccess']=()=>n(),q['onerror']=()=>o(q[F(0xea)]);});}async['updateLastPlayed'](h){const G=B;return this[G(0x112)](G(0xef),(j,k,n)=>{const I=G,o=j['get'](h);o['onsuccess']=()=>{const H=e,q=o[H(0x10f)];if(q){q['lastPlayed']=new Date()[H(0xfc)]();const u=j[H(0x102)](q);u[H(0x111)]=()=>k(),u['onerror']=()=>n(u['error']);}else k();},o['onerror']=()=>n(o[I(0xea)]);});}async['cleanupOld'](){const J=B,h={'hGlza':function(i,j){return i*j;}};return this[J(0x112)](J(0xef),(j,k,n)=>{const K=J,o=j['openCursor'](),q=Date[K(0xfa)]()-h['hGlza'](h[K(0x12e)](0x10e0,0x3c),0x3e8);o[K(0x111)]=u=>{const L=K,v=u['target']['result'];if(v){const x=v['value'];new Date(x[L(0xf0)]||x[L(0xdc)])[L(0x105)]()<q&&v['delete'](),v[L(0x146)]();}else k();},o['onerror']=()=>n(o['error']);});}async[B(0xeb)](h){const M=B,j={'BOtew':'readonly'};return this[M(0x112)](j['BOtew'],(k,n,o)=>{const N=M,q=k[N(0x132)](h);q['onsuccess']=()=>n(q['result']),q[N(0xdd)]=()=>o(q[N(0xea)]);});}async[B(0xfb)](){const O=B;return this['dbAction'](O(0x131),(h,j,k)=>{const P=O,n=h['getAll']();n[P(0x111)]=()=>j(n['result']||[]),n['onerror']=()=>k(n[P(0xea)]);});}['isBinary'](h){const Q=B,j=h[Q(0x107)]('.')['pop']()[Q(0x145)]();return!m['has'](j);}async[B(0xff)](h){const R=B,j={'CiPkS':R(0x126),'FgNPw':'string'},k=await(await fetch(h))['blob'](),q=await new f()[R(0x109)](k),t={};for(const [u,v]of Object[R(0x139)](q[R(0x13e)]))if(!v[R(0x12c)]){const x=this[R(0x125)](u);t[u]={'content':await v['async'](x?j[R(0x144)]:j[R(0x10e)]),'mime':this['getMime'](u),'binary':x};}return t;}async['extractMultipleZips'](h){const S=B,j={};for(const k of h){const n=await this[S(0xff)](k);Object[S(0x122)](j,n);}return j;}[B(0x11d)](h){const T=B,j={'IWQHB':'text/html','iEwhM':T(0x101),'mLWdE':T(0x127),'qvzTY':'text/markdown','QOOux':T(0x113),'EWBJo':T(0x12f),'JIfEp':'image/gif','zjyvG':T(0xfe),'BsyOt':T(0x10a),'pZXLd':'font/ttf','Wjcfc':'application/vnd.ms-fontobject','rYhBB':'video/mp4','NcFBZ':'video/webm','NneqH':'application/zip','UNTrN':'application/octet-stream'},k=h['split']('.')['pop']()[T(0x145)]();return{'html':j[T(0x115)],'htm':j[T(0x115)],'css':T(0xe4),'js':j[T(0x118)],'mjs':j['iEwhM'],'json':j['mLWdE'],'xml':'application/xml','txt':'text/plain','md':j[T(0x143)],'csv':T(0x137),'png':j['QOOux'],'jpg':j['EWBJo'],'jpeg':'image/jpeg','gif':j[T(0x142)],'svg':j['zjyvG'],'ico':T(0xe9),'webp':j[T(0x13f)],'bmp':'image/bmp','avif':'image/avif','woff':'font/woff','woff2':T(0x11e),'ttf':j['pZXLd'],'otf':T(0x138),'eot':j[T(0x106)],'mp3':'audio/mpeg','wav':T(0xf1),'ogg':'audio/ogg','m4a':T(0x134),'aac':'audio/aac','mp4':j['rYhBB'],'webm':j[T(0xee)],'ogv':T(0x119),'wasm':'application/wasm','zip':j[T(0x136)],'gz':T(0x114),'pdf':'application/pdf','data':T(0x133),'unityweb':T(0x133),'bundle':T(0x133),'bin':'application/octet-stream','dat':'application/octet-stream','mem':T(0x133),'asset':T(0x133),'resource':j[T(0x117)]}[k]||T(0x133);}async[B(0x10d)](){const U=B,h={'Kqyni':'controllerchange','jpoIs':'SKIP_WAITING','afOxb':'from\x20local\x20gm\x20loader'};if(U(0xe3)in navigator)try{let j=(await navigator[U(0xe3)][U(0x100)]())[U(0x11a)](k=>k['active']?.[U(0xec)]['includes']('/loadersw.js'));if(!j){const k=await navigator[U(0xe3)]['register'](new URL('./loadersw.js',location[U(0x121)])[U(0x121)],{'scope':'/','updateViaCache':'none'});return await navigator['serviceWorker'][U(0xe1)],navigator['serviceWorker'][U(0x110)]||await new Promise(n=>{const V=U;navigator['serviceWorker'][V(0x10c)](h[V(0x11c)],n,{'once':!0x0});}),k;}if((j[U(0x104)]||j[U(0xed)])&&await new Promise(n=>{const W=U,o={'zZRQi':function(r){return r();}},q=j[W(0x104)]||j[W(0xed)];q['addEventListener']('statechange',()=>{q['state']==='activated'&&o['zZRQi'](n);});}),!navigator['serviceWorker']['controller']){const n=(await navigator[U(0xe3)]['ready'])['active'];n&&(n['postMessage']({'type':h[U(0x10b)]}),await new Promise(o=>{const X=U;navigator['serviceWorker'][X(0x10c)](X(0x120),o,{'once':!0x0});}));}return j;}catch(o){console[U(0xea)](h[U(0xf3)],o);}}async[B(0x11b)](h,j){const Y=B;await this['regSW'](),await this['initDB']();const k=Array[Y(0x12a)](h),n=(k?h[0x0]:h)[Y(0x107)]('/')[Y(0x13c)]()['replace'](Y(0xde),'')||Y(0x140)+Date[Y(0xfa)]();if(await this[Y(0xeb)](n))return await this['updateLastPlayed'](n),{'url':new URL(Y(0xda)+n+Y(0x11f),location['href'])[Y(0x121)],'cached':!0x0};j&&j(!0x0);const q=k?await this[Y(0x130)](h):await this[Y(0xff)](h);return await this[Y(0xf2)](n,q),j&&j(!0x1),{'url':new URL(Y(0xda)+n+Y(0x11f),location['href'])[Y(0x121)],'cached':!0x1};}}function e(a,b){a=a-0xda;const c=d();let f=c[a];return f;}export{w as default};