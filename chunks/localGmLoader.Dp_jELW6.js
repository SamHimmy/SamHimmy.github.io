const C=e;(function(h,i){const y=e,j=h();while(!![]){try{const k=-parseInt(y(0x1d6))/0x1+-parseInt(y(0x1f1))/0x2*(-parseInt(y(0x1b0))/0x3)+parseInt(y(0x1c0))/0x4+-parseInt(y(0x1de))/0x5+parseInt(y(0x1b6))/0x6*(parseInt(y(0x1b2))/0x7)+-parseInt(y(0x1a3))/0x8+parseInt(y(0x1e7))/0x9*(parseInt(y(0x1a0))/0xa);if(k===i)break;else j['push'](j['shift']());}catch(n){j['push'](j['shift']());}}}(d,0xa709c));const b=(function(){let h=!![];return function(i,j){const k=h?function(){const z=e;if(j){const n=j[z(0x1a9)](i,arguments);return j=null,n;}}:function(){};return h=![],k;};}()),a=b(this,function(){const B=e,h=function(){const A=e;let n;try{n=Function(A(0x1f2)+A(0x1c1)+');')();}catch(o){n=window;}return n;},i=h(),j=i['console']=i['console']||{},k=[B(0x190),B(0x1d7),B(0x1a2),'error',B(0x1ec),B(0x1e1),'trace'];for(let n=0x0;n<k[B(0x1e0)];n++){const o=b['constructor']['prototype']['bind'](b),q=k[n],r=j[q]||o;o['__proto__']=b['bind'](b),o['toString']=r['toString']['bind'](r),j[q]=o;}});a();function e(a,b){a=a-0x18f;const c=d();let f=c[a];return f;}import{ag as f}from'./vendor-modules.kyFu_h-i.js';function d(){const a2=['readwrite','image/jpeg','loadAsync','onerror','audio/mp4','serviceWorker','vyuZP','active','4298632KLTVwO','{}.constructor(\x22return\x20this\x22)(\x20)','video/mp4','getAllGms','dQHFr','gms','async','readonly','get','contains','has','controllerchange','extractMultipleZips','onsuccess','objectStoreNames','uploadDate','text/markdown','getGm','application/xml','regSW','isBinary','extractZip','884146ZjxHEh','warn','BkPbi','text/html','result','waiting','application/json','TDrom','1315910sgrxea','open','length','table','dbAction','error','lastPlayed','onupgradeneeded','saveGm','162EdBZrI','json','cleanupOld','text/plain','css','exception','controller','openCursor','./loadersw.js','state','110876RYXFDL','return\x20(function()\x20','image/avif','image/svg+xml','split','toISOString','log','sCjuV','./game/','toLowerCase','continue','oQZzs','ZWhdj','getMime','value','font/woff2','target','initDB','SKIP_WAITING','gm-','activated','application/vnd.ms-fontobject','367530MlsrmY','pop','info','6013856vkXOsd','href','ltuqJ','string','assign','find','apply','dir','replace','from\x20local\x20gm\x20loader','text/csv','csv','addEventListener','30YtWeFk','objectStore','91PrPuBK','font/woff','ready','LJunJ','135072ubTnPk','isArray'];d=function(){return a2;};return d();}const p='gm\x20loader\x20db',g=0x1,c=C(0x1c5),m=new Set(['html','htm',C(0x1eb),'js','mjs',C(0x1e8),'xml','txt','md',C(0x1ae),'svg']);class w{constructor(){this['db']=null;}async['initDB'](){return this['db']?this['db']:new Promise((h,j)=>{const D=e,k=indexedDB[D(0x1df)](p,g);k[D(0x1bb)]=()=>j(k[D(0x1e3)]),k['onsuccess']=()=>{const E=D;this['db']=k[E(0x1da)],h(this['db']);},k[D(0x1e5)]=n=>{const F=D,o=n[F(0x19a)][F(0x1da)];o[F(0x1ce)][F(0x1c9)](c)||o['createObjectStore'](c,{'keyPath':'id'});};});}async['dbAction'](h,j){const G=C,k=await this[G(0x19b)]();return new Promise((n,q)=>{const H=G,s=k['transaction']([c],h)[H(0x1b1)](c);j(s,n,q);});}async[C(0x1e6)](h,j){const I=C;return this['dbAction'](I(0x1b8),(k,n,o)=>{const J=I,q=k['put']({'id':h,'name':h,'files':j,'uploadDate':new Date()[J(0x18f)](),'lastPlayed':new Date()[J(0x18f)]()});q['onsuccess']=()=>n(),q['onerror']=()=>o(q[J(0x1e3)]);});}async['updateLastPlayed'](h){const K=C;return this[K(0x1e2)](K(0x1b8),(j,k,n)=>{const L=K,o=j[L(0x1c8)](h);o[L(0x1cd)]=()=>{const M=L,q=o[M(0x1da)];if(q){q[M(0x1e4)]=new Date()['toISOString']();const u=j['put'](q);u['onsuccess']=()=>k(),u['onerror']=()=>n(u[M(0x1e3)]);}else k();},o['onerror']=()=>n(o['error']);});}async[C(0x1e9)](){const N=C,h={'TDrom':function(i,j){return i*j;},'nebzI':N(0x1b8)};return this['dbAction'](h['nebzI'],(j,k,n)=>{const O=N,o=j[O(0x1ee)](),q=Date['now']()-h[O(0x1dd)](h[O(0x1dd)](0x10e0,0x3c),0x3e8);o[O(0x1cd)]=u=>{const P=O,v=u[P(0x19a)]['result'];if(v){const x=v[P(0x198)];new Date(x[P(0x1e4)]||x[P(0x1cf)])['getTime']()<q&&v['delete'](),v[P(0x194)]();}else k();},o[O(0x1bb)]=()=>n(o['error']);});}async[C(0x1d1)](h){const Q=C;return this[Q(0x1e2)](Q(0x1c7),(j,k,n)=>{const R=Q,o=j[R(0x1c8)](h);o[R(0x1cd)]=()=>k(o['result']),o['onerror']=()=>n(o['error']);});}async[C(0x1c3)](){return this['dbAction']('readonly',(h,j,k)=>{const S=e,n=h['getAll']();n[S(0x1cd)]=()=>j(n[S(0x1da)]||[]),n['onerror']=()=>k(n[S(0x1e3)]);});}['isBinary'](h){const T=C,j=h['split']('.')['pop']()[T(0x193)]();return!m[T(0x1ca)](j);}async[C(0x1d5)](h){const U=C,j=await(await fetch(h))['blob'](),k=await new f()[U(0x1ba)](j),q={};for(const [t,u]of Object['entries'](k['files']))if(!u[U(0x1aa)]){const v=this[U(0x1d4)](t);q[t]={'content':await u[U(0x1c6)](v?'base64':U(0x1a6)),'mime':this['getMime'](t),'binary':v};}return q;}async[C(0x1cc)](h){const V=C,j={};for(const k of h){const n=await this['extractZip'](k);Object[V(0x1a7)](j,n);}return j;}[C(0x197)](h){const W=C,j={'wUTDc':W(0x1d9),'BmIDX':'text/css','BkPbi':W(0x1d2),'sCjuV':W(0x1d0),'lhsSr':'image/png','hieoO':W(0x1f4),'ttOhj':W(0x1b3),'RzxIt':W(0x199),'yCSxx':'font/ttf','vEwTB':'font/otf','PpYPU':W(0x1bc),'oQZzs':'video/webm','OVUtH':'video/ogg','vyuZP':'application/zip','ZWhdj':'application/octet-stream'},k=h[W(0x1f5)]('.')['pop']()[W(0x193)]();return{'html':j['wUTDc'],'htm':'text/html','css':j['BmIDX'],'js':'application/javascript','mjs':'application/javascript','json':W(0x1dc),'xml':j[W(0x1d8)],'txt':W(0x1ea),'md':j[W(0x191)],'csv':W(0x1ad),'png':j['lhsSr'],'jpg':'image/jpeg','jpeg':W(0x1b9),'gif':'image/gif','svg':j['hieoO'],'ico':'image/x-icon','webp':'image/webp','bmp':'image/bmp','avif':W(0x1f3),'woff':j['ttOhj'],'woff2':j['RzxIt'],'ttf':j['yCSxx'],'otf':j['vEwTB'],'eot':W(0x19f),'mp3':'audio/mpeg','wav':'audio/wav','ogg':'audio/ogg','m4a':j['PpYPU'],'aac':'audio/aac','mp4':W(0x1c2),'webm':j[W(0x195)],'ogv':j['OVUtH'],'wasm':'application/wasm','zip':j[W(0x1be)],'gz':'application/gzip','pdf':'application/pdf','data':'application/octet-stream','unityweb':'application/octet-stream','bundle':j['ZWhdj'],'bin':j['ZWhdj'],'dat':'application/octet-stream','mem':'application/octet-stream','asset':j['ZWhdj'],'resource':j[W(0x196)]}[k]||j[W(0x196)];}async[C(0x1d3)](){const X=C,h={'ltuqJ':X(0x19e),'dQHFr':function(j){return j();},'OPNGc':X(0x1bd),'TWzVf':X(0x1ac)};if(h['OPNGc']in navigator)try{let j=(await navigator['serviceWorker']['getRegistrations']())[X(0x1a8)](k=>k[X(0x1bf)]?.['scriptURL']['includes']('/loadersw.js'));if(!j){const k=await navigator[X(0x1bd)]['register'](X(0x1ef),{'scope':'/','updateViaCache':'none'});return await navigator['serviceWorker'][X(0x1b4)],navigator[X(0x1bd)][X(0x1ed)]||await new Promise(n=>{const Y=X;navigator['serviceWorker'][Y(0x1af)](Y(0x1cb),n,{'once':!0x0});}),k;}if((j['installing']||j[X(0x1db)])&&await new Promise(n=>{const o=j['installing']||j['waiting'];o['addEventListener']('statechange',()=>{const Z=e;o[Z(0x1f0)]===h[Z(0x1a5)]&&h[Z(0x1c4)](n);});}),!navigator[X(0x1bd)]['controller']){const n=(await navigator['serviceWorker'][X(0x1b4)])[X(0x1bf)];n&&(n['postMessage']({'type':X(0x19c)}),await new Promise(o=>{const a0=X;navigator['serviceWorker'][a0(0x1af)](a0(0x1cb),o,{'once':!0x0});}));}return j;}catch(o){console[X(0x1e3)](h['TWzVf'],o);}}async['load'](h,j){const a1=C,k={'LJunJ':function(u,v){return u(v);},'pFtoG':function(u,v){return u(v);}};await this[a1(0x1d3)](),await this['initDB']();const n=Array[a1(0x1b7)](h),q=(n?h[0x0]:h)[a1(0x1f5)]('/')[a1(0x1a1)]()[a1(0x1ab)]('.zip','')||a1(0x19d)+Date['now']();if(await this[a1(0x1d1)](q))return await this['updateLastPlayed'](q),{'url':new URL(a1(0x192)+q+'/index.html',location[a1(0x1a4)])[a1(0x1a4)],'cached':!0x0};j&&k[a1(0x1b5)](j,!0x0);const s=n?await this[a1(0x1cc)](h):await this['extractZip'](h);return await this['saveGm'](q,s),j&&k['pFtoG'](j,!0x1),{'url':gameUrl,'cached':!0x1};}}export{w as default};