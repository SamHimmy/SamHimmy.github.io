const A=e;function d(){const a0=['extractZip','objectStoreNames','serviceWorker','audio/wav','HqcuU','pop','trace','error','getGm','nRRRh','ready','readonly','getRegistrations','lastPlayed','926718WBKrTz','audio/ogg','delete','image/svg+xml','cleanupOld','gm-','constructor','now','audio/mpeg','application/javascript','split','font/woff2','.zip','./loadersw.js','ysIFa','result','bind','none','base64','image/x-icon','__proto__','prototype','toISOString','assign','get','toLowerCase','exception','has','2RqzUyx','addEventListener','info','gms','postMessage','4664555FVGkkz','text/html','7243008ewtqwP','updateLastPlayed','controllerchange','35iYuqEJ','mjs','PJfLQ','1227404IRCpKh','onupgradeneeded','{}.constructor(\x22return\x20this\x22)(\x20)','WAoyM','application/vnd.ms-fontobject','onerror','regSW','image/webp','omkwr','FGEgn','video/webm','4943576qIlbAJ','dbAction','open','onsuccess','PfWHv','font/woff','5547069qlcsFb','text/csv','waiting','dASFm','18HqHncb','43728810IaLVUn','files','initDB','/index.html','image/jpeg','application/wasm','image/gif','application/octet-stream','html','console','target','/game/','txt','application/json','image/png','state','getAllGms','getMime','pcxce','load','controller','FNHfW','value','text/css','vXryT','register','includes','isBinary','replace','yvIDt','async','image/avif','extractMultipleZips','VsbJt','ERCBO','toString','SKIP_WAITING','htm'];d=function(){return a0;};return d();}(function(h,i){const y=e,j=h();while(!![]){try{const k=parseInt(y(0x20a))/0x1*(parseInt(y(0x1a4))/0x2)+parseInt(y(0x1b5))/0x3+-parseInt(y(0x1af))/0x4+parseInt(y(0x20f))/0x5+-parseInt(y(0x1ee))/0x6*(-parseInt(y(0x1a1))/0x7)+-parseInt(y(0x211))/0x8*(-parseInt(y(0x1b9))/0x9)+-parseInt(y(0x1ba))/0xa;if(k===i)break;else j['push'](j['shift']());}catch(n){j['push'](j['shift']());}}}(d,0xf021c));function e(a,b){a=a-0x19f;const c=d();let f=c[a];return f;}const b=(function(){let h=!![];return function(i,j){const k=h?function(){if(j){const n=j['apply'](i,arguments);return j=null,n;}}:function(){};return h=![],k;};}()),a=b(this,function(){const z=e,h={'nRRRh':function(n,o){return n(o);},'DCfCY':z(0x1a6)};let i;try{const n=h[z(0x1e9)](Function,'return\x20(function()\x20'+h['DCfCY']+');');i=n();}catch(o){i=window;}const j=i[z(0x1c3)]=i[z(0x1c3)]||{},k=['log','warn',z(0x20c),z(0x1e7),z(0x208),'table',z(0x1e6)];for(let q=0x0;q<k['length'];q++){const r=b[z(0x1f4)][z(0x203)][z(0x1fe)](b),s=k[q],t=j[s]||r;r[z(0x202)]=b['bind'](b),r[z(0x1dd)]=t['toString']['bind'](t),j[s]=r;}});a();import{ag as f}from'./vendor-modules.kyFu_h-i.js';const p='gm\x20loader\x20db',g=0x1,c=A(0x20d),m=new Set([A(0x1c2),A(0x1df),'css','js',A(0x1a2),'json','xml',A(0x1c6),'md','csv','svg']);class w{constructor(){this['db']=null;}async[A(0x1bc)](){const h={'VsbJt':function(i,j){return i(j);}};return this['db']?this['db']:new Promise((j,k)=>{const B=e,n=indexedDB[B(0x1b1)](p,g);n['onerror']=()=>k(n['error']),n['onsuccess']=()=>{const C=B;this['db']=n[C(0x1fd)],h[C(0x1db)](j,this['db']);},n[B(0x1a5)]=o=>{const D=B,q=o[D(0x1c4)]['result'];q[D(0x1e1)]['contains'](c)||q['createObjectStore'](c,{'keyPath':'id'});};});}async[A(0x1b0)](h,j){const E=A,k={'qtbul':function(o,q,r,s){return o(q,r,s);}},n=await this[E(0x1bc)]();return new Promise((q,r)=>{const u=n['transaction']([c],h)['objectStore'](c);k['qtbul'](j,u,q,r);});}async['saveGm'](h,j){const F=A;return this[F(0x1b0)]('readwrite',(k,n,o)=>{const G=F,q=k['put']({'id':h,'name':h,'files':j,'uploadDate':new Date()['toISOString'](),'lastPlayed':new Date()[G(0x204)]()});q[G(0x1b2)]=()=>n(),q[G(0x1a9)]=()=>o(q['error']);});}async[A(0x19f)](h){const j={'snSuA':'readwrite'};return this['dbAction'](j['snSuA'],(k,n,o)=>{const H=e,q=k[H(0x206)](h);q['onsuccess']=()=>{const I=H,u=q['result'];if(u){u[I(0x1ed)]=new Date()[I(0x204)]();const v=k['put'](u);v[I(0x1b2)]=()=>n(),v['onerror']=()=>o(v['error']);}else n();},q['onerror']=()=>o(q['error']);});}async[A(0x1f2)](){const J=A,h={'mVCSW':function(i,j){return i-j;},'WAoyM':function(i,j){return i*j;},'HqcuU':'readwrite'};return this['dbAction'](h[J(0x1e4)],(j,k,n)=>{const K=J,o=j['openCursor'](),q=h['mVCSW'](Date[K(0x1f5)](),h[K(0x1a7)](0x10e0*0x3c,0x3e8));o[K(0x1b2)]=u=>{const L=K,v=u['target'][L(0x1fd)];if(v){const x=v[L(0x1d0)];new Date(x[L(0x1ed)]||x['uploadDate'])['getTime']()<q&&v[L(0x1f0)](),v['continue']();}else k();},o['onerror']=()=>n(o['error']);});}async[A(0x1e8)](h){const M=A;return this[M(0x1b0)](M(0x1eb),(j,k,n)=>{const N=M,o=j[N(0x206)](h);o['onsuccess']=()=>k(o['result']),o['onerror']=()=>n(o[N(0x1e7)]);});}async[A(0x1ca)](){const O=A;return this['dbAction'](O(0x1eb),(h,j,k)=>{const P=O,n=h['getAll']();n['onsuccess']=()=>j(n['result']||[]),n[P(0x1a9)]=()=>k(n[P(0x1e7)]);});}[A(0x1d5)](h){const Q=A,j=h['split']('.')['pop']()[Q(0x207)]();return!m[Q(0x209)](j);}async['extractZip'](h){const R=A,j=await(await fetch(h))['blob'](),k=await new f()['loadAsync'](j),q={};for(const [t,u]of Object['entries'](k[R(0x1bb)]))if(!u['dir']){const v=this['isBinary'](t);q[t]={'content':await u[R(0x1d8)](v?R(0x200):'string'),'mime':this['getMime'](t),'binary':v};}return q;}async[A(0x1da)](h){const S=A,j={};for(const k of h){const n=await this[S(0x1e0)](k);Object[S(0x205)](j,n);}return j;}[A(0x1cb)](h){const T=A,j={'yvIDt':T(0x1f7),'omkwr':'text/plain','PfWHv':T(0x1b6),'fiNsA':T(0x1c8),'ERCBO':T(0x201),'JiQMS':T(0x1f9),'vXryT':'font/ttf','FGEgn':'audio/mp4','LEepL':T(0x1ae),'FNHfW':T(0x1c1)},k=h[T(0x1f8)]('.')[T(0x1e5)]()[T(0x207)]();return{'html':T(0x210),'htm':T(0x210),'css':T(0x1d1),'js':j[T(0x1d7)],'mjs':T(0x1f7),'json':T(0x1c7),'xml':'application/xml','txt':j[T(0x1ac)],'md':'text/markdown','csv':j[T(0x1b3)],'png':j['fiNsA'],'jpg':T(0x1be),'jpeg':'image/jpeg','gif':T(0x1c0),'svg':T(0x1f1),'ico':j[T(0x1dc)],'webp':T(0x1ab),'bmp':'image/bmp','avif':T(0x1d9),'woff':T(0x1b4),'woff2':j['JiQMS'],'ttf':j[T(0x1d2)],'otf':'font/otf','eot':T(0x1a8),'mp3':T(0x1f6),'wav':T(0x1e3),'ogg':T(0x1ef),'m4a':j[T(0x1ad)],'aac':'audio/aac','mp4':'video/mp4','webm':j['LEepL'],'ogv':'video/ogg','wasm':T(0x1bf),'zip':'application/zip','gz':'application/gzip','pdf':'application/pdf','data':'application/octet-stream','unityweb':T(0x1c1),'bundle':'application/octet-stream','bin':'application/octet-stream','dat':j[T(0x1cf)],'mem':T(0x1c1),'asset':T(0x1c1),'resource':T(0x1c1)}[k]||T(0x1c1);}async[A(0x1aa)](){const U=A,h={'ysIFa':function(j,k){return j===k;},'pcxce':'activated','PJfLQ':'serviceWorker','SOjQi':U(0x1de)};if(h[U(0x1a3)]in navigator)try{let j=(await navigator[U(0x1e2)][U(0x1ec)]())['find'](k=>k['active']?.['scriptURL'][U(0x1d4)]('/loadersw.js'));if(!j){const k=await navigator['serviceWorker'][U(0x1d3)](U(0x1fb),{'scope':'/','updateViaCache':U(0x1ff)});return await navigator[U(0x1e2)][U(0x1ea)],navigator['serviceWorker']['controller']||await new Promise(n=>{const V=U;navigator[V(0x1e2)][V(0x20b)](V(0x1a0),n,{'once':!0x0});}),k;}if((j['installing']||j['waiting'])&&await new Promise(n=>{const W=U,o=j['installing']||j[W(0x1b7)];o['addEventListener']('statechange',()=>{const X=W;h[X(0x1fc)](o[X(0x1c9)],h[X(0x1cc)])&&n();});}),!navigator[U(0x1e2)][U(0x1ce)]){const n=(await navigator['serviceWorker'][U(0x1ea)])['active'];n&&(n[U(0x20e)]({'type':h['SOjQi']}),await new Promise(o=>{const Y=U;navigator[Y(0x1e2)]['addEventListener']('controllerchange',o,{'once':!0x0});}));}return j;}catch(o){console['error']('from\x20local\x20gm\x20loader',o);}}async[A(0x1cd)](h,j){const Z=A,k={'OEYSy':function(u,v){return u+v;},'dASFm':function(u,v){return u(v);}};await this['regSW'](),await this[Z(0x1bc)]();const n=Array['isArray'](h),q=(n?h[0x0]:h)['split']('/')[Z(0x1e5)]()[Z(0x1d6)](Z(0x1fa),'')||k['OEYSy'](Z(0x1f3),Date[Z(0x1f5)]());if(await this[Z(0x1e8)](q))return await this[Z(0x19f)](q),{'url':Z(0x1c5)+q+'/index.html','cached':!0x0};j&&k[Z(0x1b8)](j,!0x0);const r=n?await this['extractMultipleZips'](h):await this['extractZip'](h);return await this['saveGm'](q,r),j&&j(!0x1),{'url':Z(0x1c5)+q+Z(0x1bd),'cached':!0x1};}}export{w as default};