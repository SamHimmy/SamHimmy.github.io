function e(a,b){a=a-0x1a6;const c=d();let f=c[a];return f;}const A=e;(function(h,i){const y=e,j=h();while(!![]){try{const k=parseInt(y(0x207))/0x1+parseInt(y(0x1b8))/0x2+parseInt(y(0x1c9))/0x3+parseInt(y(0x1e0))/0x4*(parseInt(y(0x1e9))/0x5)+parseInt(y(0x1d7))/0x6+parseInt(y(0x1c4))/0x7*(parseInt(y(0x1d4))/0x8)+-parseInt(y(0x1cd))/0x9;if(k===i)break;else j['push'](j['shift']());}catch(n){j['push'](j['shift']());}}}(d,0x1b25b));const b=(function(){let h=!![];return function(i,j){const k=h?function(){if(j){const n=j['apply'](i,arguments);return j=null,n;}}:function(){};return h=![],k;};}()),a=b(this,function(){const z=e,h={'vpxfN':function(o,q){return o(q);},'SUoOn':'return\x20(function()\x20','nFagm':'{}.constructor(\x22return\x20this\x22)(\x20)','xwMAY':function(o){return o();},'SQJkM':z(0x213),'PvliQ':z(0x1ec)},i=function(){let o;try{o=h['vpxfN'](Function,h['SUoOn']+h['nFagm']+');')();}catch(q){o=window;}return o;},j=h['xwMAY'](i),k=j[z(0x1f0)]=j['console']||{},n=[h['SQJkM'],z(0x1f2),z(0x1d1),z(0x1d2),z(0x215),'table',h[z(0x1ff)]];for(let o=0x0;o<n[z(0x1aa)];o++){const q=b[z(0x209)][z(0x1fc)]['bind'](b),r=n[o],s=k[r]||q;q['__proto__']=b['bind'](b),q[z(0x1f9)]=s['toString']['bind'](s),k[r]=q;}});a();import{ag as f}from'./vendor-modules.kyFu_h-i.js';const p='gm\x20loader\x20db',g=0x1,c=A(0x1c6),m=new Set([A(0x1fd),A(0x1f8),A(0x1c8),'js','mjs',A(0x1f6),A(0x208),A(0x1da),'md',A(0x1f7),'svg']);class w{constructor(){this['db']=null;}async[A(0x1eb)](){return this['db']?this['db']:new Promise((h,j)=>{const B=e,k=indexedDB[B(0x20b)](p,g);k['onerror']=()=>j(k[B(0x1d2)]),k['onsuccess']=()=>{const C=B;this['db']=k[C(0x1a8)],h(this['db']);},k[B(0x1bc)]=n=>{const D=B,o=n['target']['result'];o['objectStoreNames'][D(0x20f)](c)||o['createObjectStore'](c,{'keyPath':'id'});};});}async[A(0x1ca)](h,j){const E=A,k=await this[E(0x1eb)]();return new Promise((n,q)=>{const F=E,r=k[F(0x1b5)]([c],h)[F(0x1e8)](c);j(r,n,q);});}async['saveGm'](h,j){const G=A;return this[G(0x1ca)](G(0x212),(k,n,o)=>{const H=G,q=k[H(0x1fb)]({'id':h,'name':h,'files':j,'uploadDate':new Date()[H(0x1e2)](),'lastPlayed':new Date()[H(0x1e2)]()});q[H(0x1df)]=()=>n(),q[H(0x1ba)]=()=>o(q['error']);});}async[A(0x1e5)](h){const I=A,j={'MxCZZ':function(k){return k();}};return this[I(0x1ca)]('readwrite',(k,n,o)=>{const K=I,q={'yQtbV':function(u){const J=e;return j[J(0x1dc)](u);}},r=k[K(0x1b7)](h);r['onsuccess']=()=>{const L=K,u=r['result'];if(u){u[L(0x1b2)]=new Date()[L(0x1e2)]();const v=k['put'](u);v[L(0x1df)]=()=>n(),v[L(0x1ba)]=()=>o(v['error']);}else q['yQtbV'](n);},r[K(0x1ba)]=()=>o(r['error']);});}async[A(0x1e3)](){const M=A,h={'qggna':function(i,j){return i-j;}};return this[M(0x1ca)](M(0x212),(j,k,n)=>{const N=M,o=j[N(0x1c0)](),q=h[N(0x1ce)](Date['now'](),0x10e0*0x3c*0x3e8);o['onsuccess']=u=>{const O=N,v=u['target'][O(0x1a8)];if(v){const x=v[O(0x1d6)];new Date(x['lastPlayed']||x['uploadDate'])['getTime']()<q&&v[O(0x1b3)](),v['continue']();}else k();},o[N(0x1ba)]=()=>n(o['error']);});}async[A(0x205)](h){const P=A;return this[P(0x1ca)](P(0x1ee),(j,k,n)=>{const Q=P,o=j['get'](h);o[Q(0x1df)]=()=>k(o['result']),o['onerror']=()=>n(o['error']);});}async['getAllGms'](){const R=A,h={'rYSQi':'readonly'};return this[R(0x1ca)](h['rYSQi'],(j,k,n)=>{const S=R,o=j[S(0x20c)]();o['onsuccess']=()=>k(o['result']||[]),o['onerror']=()=>n(o[S(0x1d2)]);});}['isBinary'](h){const T=A,j=h[T(0x1d5)]('.')[T(0x1ab)]()['toLowerCase']();return!m[T(0x214)](j);}async['extractZip'](h){const U=A,j=await(await fetch(h))[U(0x1fe)](),k=await new f()['loadAsync'](j),q={};for(const [t,u]of Object['entries'](k['files']))if(!u['dir']){const v=this['isBinary'](t);q[t]={'content':await u[U(0x1c7)](v?'base64':U(0x1db)),'mime':this['getMime'](t),'binary':v};}return q;}async['extractMultipleZips'](h){const V=A,j={};for(const k of h){const n=await this['extractZip'](k);Object[V(0x1c3)](j,n);}return j;}[A(0x211)](h){const W=A,j={'HUePj':W(0x1f3),'eHhTb':'application/json','rLKMM':W(0x1e6),'ssHSG':'image/webp','CoTLY':'image/bmp','YYwiD':W(0x217),'HyAkD':W(0x1a7),'ticGB':W(0x1b1),'YoUID':W(0x201),'VTSsV':'audio/aac','UenrR':W(0x1ed),'cOegv':'application/wasm','YzkrG':'application/zip','UGCRA':W(0x206)},k=h['split']('.')['pop']()['toLowerCase']();return{'html':'text/html','htm':W(0x1f4),'css':'text/css','js':'application/javascript','mjs':j[W(0x1bb)],'json':j['eHhTb'],'xml':'application/xml','txt':'text/plain','md':j[W(0x1ea)],'csv':W(0x1d3),'png':W(0x1ac),'jpg':W(0x1f5),'jpeg':W(0x1f5),'gif':W(0x1e1),'svg':W(0x20e),'ico':'image/x-icon','webp':j[W(0x200)],'bmp':j['CoTLY'],'avif':'image/avif','woff':j['YYwiD'],'woff2':'font/woff2','ttf':W(0x1c5),'otf':W(0x1a6),'eot':'application/vnd.ms-fontobject','mp3':j[W(0x1be)],'wav':W(0x1e7),'ogg':j['ticGB'],'m4a':j['YoUID'],'aac':j['VTSsV'],'mp4':W(0x1b6),'webm':j[W(0x1cb)],'ogv':'video/ogg','wasm':j[W(0x1c1)],'zip':j[W(0x1fa)],'gz':W(0x1c2),'pdf':W(0x1bd),'data':j[W(0x1d0)],'unityweb':'application/octet-stream','bundle':W(0x206),'bin':'application/octet-stream','dat':j['UGCRA'],'mem':'application/octet-stream','asset':'application/octet-stream','resource':'application/octet-stream'}[k]||'application/octet-stream';}async['regSW'](){const X=A,h={'OHxYg':'statechange','zDkja':function(j,k){return j in k;},'fYAid':X(0x1b4),'jRQnY':X(0x1cc)};if(h[X(0x216)]('serviceWorker',navigator))try{let j=(await navigator[X(0x1ae)]['getRegistrations']())['find'](k=>k['active']?.['scriptURL']['includes']('/loadersw.js'));if(!j){const k=await navigator['serviceWorker'][X(0x1cf)]('/loadersw.js',{'scope':'/','updateViaCache':X(0x1d9)});return await navigator[X(0x1ae)]['ready'],navigator[X(0x1ae)]['controller']||await new Promise(n=>{const Y=X;navigator['serviceWorker']['addEventListener'](Y(0x1b0),n,{'once':!0x0});}),k;}if((j['installing']||j['waiting'])&&await new Promise(n=>{const Z=X,o={'uMtzJ':function(r){return r();}},q=j[Z(0x1bf)]||j[Z(0x202)];q['addEventListener'](h['OHxYg'],()=>{const a0=Z;q['state']===a0(0x1e4)&&o[a0(0x210)](n);});}),!navigator['serviceWorker'][X(0x1de)]){const n=(await navigator['serviceWorker']['ready'])[X(0x1af)];n&&(n[X(0x1ef)]({'type':h[X(0x1d8)]}),await new Promise(o=>{const a1=X;navigator['serviceWorker'][a1(0x1b9)]('controllerchange',o,{'once':!0x0});}));}return j;}catch(o){console[X(0x1d2)](h[X(0x20d)],o);}}async['load'](h,j){const a2=A,k={'dpsxi':'.zip','mYdho':'gm-'};await this['regSW'](),await this[a2(0x1eb)]();const n=Array[a2(0x1ad)](h),q=(n?h[0x0]:h)[a2(0x1d5)]('/')['pop']()[a2(0x204)](k['dpsxi'],'')||k[a2(0x20a)]+Date[a2(0x203)]();if(await this['getGm'](q))return await this['updateLastPlayed'](q),{'url':'/game/'+q+a2(0x1f1),'cached':!0x0};j&&j(!0x0);const r=n?await this[a2(0x1dd)](h):await this['extractZip'](h);return await this[a2(0x1a9)](q,r),j&&j(!0x1),{'url':'/game/'+q+'/index.html','cached':!0x1};}}export{w as default};function d(){const a3=['text/markdown','audio/wav','objectStore','230xkMsNT','rLKMM','initDB','trace','video/webm','readonly','postMessage','console','/index.html','warn','application/javascript','text/html','image/jpeg','json','csv','htm','toString','YzkrG','put','prototype','html','blob','PvliQ','ssHSG','audio/mp4','waiting','now','replace','getGm','application/octet-stream','159608NZBYCO','xml','constructor','mYdho','open','getAll','jRQnY','image/svg+xml','contains','uMtzJ','getMime','readwrite','log','has','exception','zDkja','font/woff','font/otf','audio/mpeg','result','saveGm','length','pop','image/png','isArray','serviceWorker','active','controllerchange','audio/ogg','lastPlayed','delete','SKIP_WAITING','transaction','video/mp4','get','3088qPfRdK','addEventListener','onerror','HUePj','onupgradeneeded','application/pdf','HyAkD','installing','openCursor','cOegv','application/gzip','assign','7SODMkj','font/ttf','gms','async','css','18264TlvNOr','dbAction','UenrR','from\x20local\x20gm\x20loader','4256595lFIUHL','qggna','register','UGCRA','info','error','text/csv','1080392lQZGao','split','value','834738vlfuXj','fYAid','none','txt','string','MxCZZ','extractMultipleZips','controller','onsuccess','12412qLdFEk','image/gif','toISOString','cleanupOld','activated','updateLastPlayed'];d=function(){return a3;};return d();}