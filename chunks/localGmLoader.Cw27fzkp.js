const A=e;(function(h,i){const y=e,j=h();while(!![]){try{const k=-parseInt(y(0x114))/0x1+-parseInt(y(0x15b))/0x2*(-parseInt(y(0xff))/0x3)+parseInt(y(0x142))/0x4*(parseInt(y(0x14d))/0x5)+-parseInt(y(0x14f))/0x6+-parseInt(y(0x167))/0x7+-parseInt(y(0x12c))/0x8*(parseInt(y(0x100))/0x9)+parseInt(y(0x155))/0xa;if(k===i)break;else j['push'](j['shift']());}catch(n){j['push'](j['shift']());}}}(d,0x61193));const b=(function(){let h=!![];return function(i,j){const k=h?function(){if(j){const n=j['apply'](i,arguments);return j=null,n;}}:function(){};return h=![],k;};}()),a=b(this,function(){const z=e,h={'MpmkP':function(n,o){return n+o;},'duvKo':function(n){return n();},'pHMTm':z(0x168)};let i;try{const n=Function(h[z(0x12e)](z(0x140),'{}.constructor(\x22return\x20this\x22)(\x20)')+');');i=h[z(0x128)](n);}catch(o){i=window;}const j=i[z(0x141)]=i[z(0x141)]||{},k=[z(0x10e),'warn',h[z(0x13a)],'error',z(0x129),'table',z(0x11f)];for(let q=0x0;q<k['length'];q++){const r=b[z(0x151)]['prototype']['bind'](b),s=k[q],t=j[s]||r;r['__proto__']=b['bind'](b),r['toString']=t['toString'][z(0x12b)](t),j[s]=r;}});a();function d(){const X=['initDB','dJwWl','loadAsync','from\x20local\x20gm\x20loader','gms','trace','getRegistrations','text/csv','DIkKU','NEWJB','/index.html','open','delete','string','duvKo','exception','application/octet-stream','bind','56024dynMAl','contains','MpmkP','gm\x20loader\x20db','installing','EMKmj','image/png','WhPtO','replace','blob','saveGm','image/gif','error','ready','pHMTm','lastPlayed','serviceWorker','mjs','Mffax','waiting','return\x20(function()\x20','console','4LpCEHZ','readwrite','hnSIl','sglJj','getAllGms','addEventListener','extractZip','result','onerror','html','font/woff','2052455Gjrbfv','image/jpeg','2644152zqHktz','xml','constructor','json','isBinary','controllerchange','8270890JDycgq','svg','css','htm','image/svg+xml','objectStoreNames','1386166MMKbHd','dir','regSW','activated','application/vnd.ms-fontobject','toISOString','target','lrFfc','get','getGm','entries','pop','3796184InCjzo','info','dbAction','async','wwyRy','onsuccess','3wKSoOQ','612yivsCt','active','cleanupOld','files','readonly','state','image/bmp','NHOyx','image/avif','isArray','yBUsa','load','lvloH','now','log','updateLastPlayed','text/html','controller','audio/mpeg','getMime','73740vrTsoX','transaction','hYppM','/loadersw.js','openCursor','scriptURL'];d=function(){return X;};return d();}import{ag as f}from'./vendor-modules.kyFu_h-i.js';function e(a,b){a=a-0xfe;const c=d();let f=c[a];return f;}const p=A(0x12f),g=0x1,c=A(0x11e),m=new Set([A(0x14b),A(0x158),A(0x157),'js',A(0x13d),A(0x152),A(0x150),'txt','md','csv',A(0x156)]);class w{constructor(){this['db']=null;}async['initDB'](){return this['db']?this['db']:new Promise((h,j)=>{const B=e,k=indexedDB[B(0x125)](p,g);k[B(0x14a)]=()=>j(k['error']),k['onsuccess']=()=>{this['db']=k['result'],h(this['db']);},k['onupgradeneeded']=n=>{const C=B,o=n[C(0x161)]['result'];o[C(0x15a)][C(0x12d)](c)||o['createObjectStore'](c,{'keyPath':'id'});};});}async['dbAction'](h,j){const D=A,k={'vGRdP':function(o,q,r,s){return o(q,r,s);}},n=await this[D(0x11a)]();return new Promise((q,r)=>{const E=D,u=n[E(0x115)]([c],h)['objectStore'](c);k['vGRdP'](j,u,q,r);});}async['saveGm'](h,j){const F=A;return this['dbAction'](F(0x143),(k,n,o)=>{const G=F,q=k['put']({'id':h,'name':h,'files':j,'uploadDate':new Date()[G(0x160)](),'lastPlayed':new Date()['toISOString']()});q['onsuccess']=()=>n(),q[G(0x14a)]=()=>o(q['error']);});}async[A(0x10f)](h){const H=A;return this[H(0x169)](H(0x143),(j,k,n)=>{const I=H,o=j['get'](h);o[I(0xfe)]=()=>{const J=I,q=o['result'];if(q){q['lastPlayed']=new Date()[J(0x160)]();const u=j['put'](q);u['onsuccess']=()=>k(),u['onerror']=()=>n(u['error']);}else k();},o['onerror']=()=>n(o[I(0x138)]);});}async[A(0x102)](){const h={'dJwWl':function(i,j){return i*j;}};return this['dbAction']('readwrite',(j,k,n)=>{const K=e,o=j[K(0x118)](),q=Date['now']()-h[K(0x11b)](0x10e0,0x3c)*0x3e8;o['onsuccess']=u=>{const L=K,v=u['target']['result'];if(v){const x=v['value'];new Date(x[L(0x13b)]||x['uploadDate'])['getTime']()<q&&v[L(0x126)](),v['continue']();}else k();},o[K(0x14a)]=()=>n(o['error']);});}async['getGm'](h){return this['dbAction']('readonly',(j,k,n)=>{const M=e,o=j[M(0x163)](h);o[M(0xfe)]=()=>k(o[M(0x149)]),o['onerror']=()=>n(o[M(0x138)]);});}async[A(0x146)](){const N=A;return this['dbAction'](N(0x104),(h,j,k)=>{const O=N,n=h['getAll']();n[O(0xfe)]=()=>j(n['result']||[]),n[O(0x14a)]=()=>k(n['error']);});}['isBinary'](h){const P=A,j=h['split']('.')[P(0x166)]()['toLowerCase']();return!m['has'](j);}async[A(0x148)](h){const Q=A,j={'Mffax':function(u,v){return u(v);},'hYppM':Q(0x127)},k=await(await j[Q(0x13e)](fetch,h))[Q(0x135)](),q=await new f()[Q(0x11c)](k),t={};for(const [u,v]of Object[Q(0x165)](q[Q(0x103)]))if(!v[Q(0x15c)]){const x=this[Q(0x153)](u);t[u]={'content':await v[Q(0x16a)](x?'base64':j[Q(0x116)]),'mime':this['getMime'](u),'binary':x};}return t;}async['extractMultipleZips'](h){const j={};for(const k of h){const n=await this['extractZip'](k);Object['assign'](j,n);}return j;}[A(0x113)](h){const R=A,j={'wwyRy':R(0x110),'LeTwD':'application/json','EMKmj':'application/xml','snbLv':'text/plain','WhPtO':R(0x132),'NEWJB':'image/jpeg','XMFtE':R(0x108),'lvloH':'font/woff2','NciJr':'font/ttf','lrFfc':'audio/ogg','bPhZe':'video/mp4','NHOyx':'application/wasm','VyGpw':'application/gzip','lhHzT':'application/pdf','yBUsa':'application/octet-stream'},k=h['split']('.')['pop']()['toLowerCase']();return{'html':j[R(0x16b)],'htm':'text/html','css':'text/css','js':'application/javascript','mjs':'application/javascript','json':j['LeTwD'],'xml':j[R(0x131)],'txt':j['snbLv'],'md':'text/markdown','csv':R(0x121),'png':j[R(0x133)],'jpg':R(0x14e),'jpeg':j[R(0x123)],'gif':R(0x137),'svg':R(0x159),'ico':'image/x-icon','webp':'image/webp','bmp':R(0x106),'avif':j['XMFtE'],'woff':R(0x14c),'woff2':j[R(0x10c)],'ttf':j['NciJr'],'otf':'font/otf','eot':R(0x15f),'mp3':R(0x112),'wav':'audio/wav','ogg':j[R(0x162)],'m4a':'audio/mp4','aac':'audio/aac','mp4':j['bPhZe'],'webm':'video/webm','ogv':'video/ogg','wasm':j[R(0x107)],'zip':'application/zip','gz':j['VyGpw'],'pdf':j['lhHzT'],'data':'application/octet-stream','unityweb':'application/octet-stream','bundle':'application/octet-stream','bin':R(0x12a),'dat':j[R(0x10a)],'mem':'application/octet-stream','asset':j['yBUsa'],'resource':'application/octet-stream'}[k]||'application/octet-stream';}async[A(0x15d)](){const S=A,h={'QERgV':S(0x154),'VSdXO':function(j,k){return j in k;},'DIkKU':'serviceWorker'};if(h['VSdXO'](h[S(0x122)],navigator))try{let j=(await navigator[S(0x13c)][S(0x120)]())['find'](k=>k[S(0x101)]?.[S(0x119)]['includes'](S(0x117)));if(!j){const k=await navigator[S(0x13c)]['register'](S(0x117),{'scope':'/','updateViaCache':'none'});return await navigator['serviceWorker'][S(0x139)],navigator[S(0x13c)][S(0x111)]||await new Promise(n=>{const T=S;navigator[T(0x13c)]['addEventListener'](h['QERgV'],n,{'once':!0x0});}),k;}if((j[S(0x130)]||j['waiting'])&&await new Promise(n=>{const U=S,o=j['installing']||j[U(0x13f)];o[U(0x147)]('statechange',()=>{const V=U;o[V(0x105)]===V(0x15e)&&n();});}),!navigator[S(0x13c)]['controller']){const n=(await navigator[S(0x13c)]['ready'])[S(0x101)];n&&(n['postMessage']({'type':'SKIP_WAITING'}),await new Promise(o=>{navigator['serviceWorker']['addEventListener'](h['QERgV'],o,{'once':!0x0});}));}return j;}catch(o){console[S(0x138)](S(0x11d),o);}}async[A(0x10b)](h,j){const W=A,k={'sglJj':'.zip','hnSIl':function(u,v){return u+v;},'FmCde':'gm-'};await this['regSW'](),await this['initDB']();const n=Array[W(0x109)](h),q=(n?h[0x0]:h)['split']('/')[W(0x166)]()[W(0x134)](k[W(0x145)],'')||k[W(0x144)](k['FmCde'],Date[W(0x10d)]());if(await this[W(0x164)](q))return await this[W(0x10f)](q),{'url':'/game/'+q+W(0x124),'cached':!0x0};j&&j(!0x0);const r=n?await this['extractMultipleZips'](h):await this['extractZip'](h);return await this[W(0x136)](q,r),j&&j(!0x1),{'url':'/game/'+q+'/index.html','cached':!0x1};}}export{w as default};