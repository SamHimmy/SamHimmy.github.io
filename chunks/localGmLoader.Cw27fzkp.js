const B=e;(function(h,i){const y=e,j=h();while(!![]){try{const k=parseInt(y(0x14d))/0x1*(-parseInt(y(0x122))/0x2)+parseInt(y(0x18d))/0x3+parseInt(y(0x134))/0x4*(parseInt(y(0x121))/0x5)+parseInt(y(0x12f))/0x6+-parseInt(y(0x15f))/0x7+parseInt(y(0x170))/0x8*(parseInt(y(0x182))/0x9)+-parseInt(y(0x177))/0xa*(parseInt(y(0x188))/0xb);if(k===i)break;else j['push'](j['shift']());}catch(n){j['push'](j['shift']());}}}(d,0x8f68e));const b=(function(){let h=!![];return function(i,j){const k=h?function(){if(j){const n=j['apply'](i,arguments);return j=null,n;}}:function(){};return h=![],k;};}()),a=b(this,function(){const z=e,h={'AgcLy':function(o,q){return o+q;},'gUVLf':'warn','qQDhx':z(0x174)},i=function(){const A=z;let o;try{o=Function(h['AgcLy'](A(0x180)+A(0x135),');'))();}catch(q){o=window;}return o;},j=i(),k=j['console']=j[z(0x13b)]||{},n=[z(0x138),h['gUVLf'],z(0x14c),h['qQDhx'],z(0x18b),z(0x176),'trace'];for(let o=0x0;o<n[z(0x161)];o++){const q=b[z(0x17b)]['prototype'][z(0x179)](b),r=n[o],s=k[r]||q;q['__proto__']=b[z(0x179)](b),q[z(0x168)]=s[z(0x168)][z(0x179)](s),k[r]=q;}});a();import{ag as f}from'./vendor-modules.kyFu_h-i.js';function d(){const a1=['onupgradeneeded','from\x20local\x20gm\x20loader','.zip','HjQOo','3928NNfQUc','uploadDate','application/wasm','getRegistrations','error','image/x-icon','table','3290XabTYS','result','bind','application/pdf','constructor','register','ready','transaction','state','return\x20(function()\x20','put','5634uehwjj','regSW','gms','image/png','font/woff2','createObjectStore','41349iVoWxZ','gm-','font/woff','exception','addEventListener','1728216ROsSmi','xml','base64','split','audio/mp4','string','updateLastPlayed','readwrite','292930JBewSn','14MCpIvK','objectStoreNames','text/csv','vxwhy','find','mjs','active','audio/mpeg','controller','video/mp4','application/javascript','entries','lastPlayed','2539884SUkLpH','lmukm','toISOString','css','now','40mwGSfd','{}.constructor(\x22return\x20this\x22)(\x20)','zbvLu','open','log','postMessage','serviceWorker','console','delete','value','getGm','html','getAll','initDB','Okyba','blob','ANSHK','waiting','wsuQi','application/xml','htm','image/webp','statechange','get','info','1049OVkPZr','text/markdown','image/jpeg','ovBBW','zrFRB','readonly','font/ttf','dir','controllerchange','target','video/webm','application/vnd.ms-fontobject','image/avif','/index.html','dbAction','getMime','scriptURL','audio/aac','428064FxzPnw','LnxGz','length','continue','onsuccess','application/octet-stream','includes','getTime','gm\x20loader\x20db','toString','saveGm','YBfys','onerror'];d=function(){return a1;};return d();}function e(a,b){a=a-0x11a;const c=d();let f=c[a];return f;}const p=B(0x167),g=0x1,c=B(0x184),m=new Set([B(0x13f),B(0x148),B(0x132),'js',B(0x127),'json',B(0x11a),'txt','md','csv','svg']);class w{constructor(){this['db']=null;}async['initDB'](){return this['db']?this['db']:new Promise((h,j)=>{const C=e,k={'Grdml':function(o,q){return o(q);}},n=indexedDB[C(0x137)](p,g);n['onerror']=()=>j(n['error']),n[C(0x163)]=()=>{const D=C;this['db']=n[D(0x178)],k['Grdml'](h,this['db']);},n[C(0x16c)]=o=>{const E=C,q=o['target'][E(0x178)];q[E(0x123)]['contains'](c)||q[E(0x187)](c,{'keyPath':'id'});};});}async['dbAction'](h,j){const F=B,k={'NFQxp':function(o,q,r,s){return o(q,r,s);}},n=await this[F(0x141)]();return new Promise((q,r)=>{const G=F,u=n[G(0x17e)]([c],h)['objectStore'](c);k['NFQxp'](j,u,q,r);});}async['saveGm'](h,j){const H=B;return this[H(0x15b)]('readwrite',(k,n,o)=>{const I=H,q=k[I(0x181)]({'id':h,'name':h,'files':j,'uploadDate':new Date()[I(0x131)](),'lastPlayed':new Date()[I(0x131)]()});q['onsuccess']=()=>n(),q['onerror']=()=>o(q['error']);});}async[B(0x11f)](h){const J=B,j={'wsuQi':'readwrite'};return this['dbAction'](j[J(0x146)],(k,n,o)=>{const K=J,q=k[K(0x14b)](h);q['onsuccess']=()=>{const L=K,u=q['result'];if(u){u[L(0x12e)]=new Date()['toISOString']();const v=k['put'](u);v['onsuccess']=()=>n(),v[L(0x16b)]=()=>o(v[L(0x174)]);}else n();},q['onerror']=()=>o(q[K(0x174)]);});}async['cleanupOld'](){const M=B,h={'LnxGz':function(i,j){return i*j;}};return this[M(0x15b)](M(0x120),(j,k,n)=>{const N=M,o={'ANSHK':function(u,v){return u<v;}},q=j['openCursor'](),r=Date['now']()-h[N(0x160)](0x10e0*0x3c,0x3e8);q[N(0x163)]=u=>{const O=N,v=u[O(0x156)][O(0x178)];if(v){const x=v[O(0x13d)];o[O(0x144)](new Date(x[O(0x12e)]||x[O(0x171)])[O(0x166)](),r)&&v[O(0x13c)](),v[O(0x162)]();}else k();},q['onerror']=()=>n(q[N(0x174)]);});}async[B(0x13e)](h){return this['dbAction']('readonly',(j,k,n)=>{const P=e,o=j[P(0x14b)](h);o[P(0x163)]=()=>k(o[P(0x178)]),o[P(0x16b)]=()=>n(o['error']);});}async['getAllGms'](){const Q=B;return this['dbAction'](Q(0x152),(h,j,k)=>{const R=Q,n=h[R(0x140)]();n['onsuccess']=()=>j(n['result']||[]),n[R(0x16b)]=()=>k(n[R(0x174)]);});}['isBinary'](h){const S=B,j=h[S(0x11c)]('.')['pop']()['toLowerCase']();return!m['has'](j);}async['extractZip'](h){const T=B,j=await(await fetch(h))[T(0x143)](),k=await new f()['loadAsync'](j),q={};for(const [t,u]of Object[T(0x12d)](k['files']))if(!u[T(0x154)]){const v=this['isBinary'](t);q[t]={'content':await u['async'](v?T(0x11b):T(0x11e)),'mime':this[T(0x15c)](t),'binary':v};}return q;}async['extractMultipleZips'](h){const j={};for(const k of h){const n=await this['extractZip'](k);Object['assign'](j,n);}return j;}[B(0x15c)](h){const U=B,j={'yrcxd':U(0x12c),'zrFRB':'application/json','YHvqZ':U(0x124),'SvuEX':U(0x14f),'CwxpM':'image/svg+xml','zbvLu':'image/bmp','wFAsD':U(0x186),'vxwhy':'font/otf','lmukm':U(0x158),'oqmmT':U(0x129),'YBfys':'audio/wav','PkXIT':'audio/ogg','HjQOo':U(0x15e),'VlhSd':U(0x172),'zEhth':'application/octet-stream'},k=h['split']('.')['pop']()['toLowerCase']();return{'html':'text/html','htm':'text/html','css':'text/css','js':'application/javascript','mjs':j['yrcxd'],'json':j[U(0x151)],'xml':U(0x147),'txt':'text/plain','md':U(0x14e),'csv':j['YHvqZ'],'png':U(0x185),'jpg':j['SvuEX'],'jpeg':U(0x14f),'gif':'image/gif','svg':j['CwxpM'],'ico':U(0x175),'webp':U(0x149),'bmp':j[U(0x136)],'avif':U(0x159),'woff':U(0x18a),'woff2':j['wFAsD'],'ttf':U(0x153),'otf':j[U(0x125)],'eot':j[U(0x130)],'mp3':j['oqmmT'],'wav':j[U(0x16a)],'ogg':j['PkXIT'],'m4a':U(0x11d),'aac':j[U(0x16f)],'mp4':U(0x12b),'webm':U(0x157),'ogv':'video/ogg','wasm':j['VlhSd'],'zip':'application/zip','gz':'application/gzip','pdf':U(0x17a),'data':U(0x164),'unityweb':'application/octet-stream','bundle':U(0x164),'bin':'application/octet-stream','dat':'application/octet-stream','mem':'application/octet-stream','asset':'application/octet-stream','resource':j['zEhth']}[k]||j['zEhth'];}async[B(0x183)](){const V=B,h={'JYMQT':'serviceWorker','XzQCO':'/loadersw.js'};if(h['JYMQT']in navigator)try{let j=(await navigator[V(0x13a)][V(0x173)]())[V(0x126)](k=>k[V(0x128)]?.[V(0x15d)][V(0x165)]('/loadersw.js'));if(!j){const k=await navigator[V(0x13a)][V(0x17c)](h['XzQCO'],{'scope':'/','updateViaCache':'none'});return await navigator[V(0x13a)]['ready'],navigator['serviceWorker'][V(0x12a)]||await new Promise(n=>{const W=V;navigator['serviceWorker'][W(0x18c)](W(0x155),n,{'once':!0x0});}),k;}if((j['installing']||j[V(0x145)])&&await new Promise(n=>{const X=V,o={'yJaqy':'activated'},q=j['installing']||j['waiting'];q['addEventListener'](X(0x14a),()=>{const Y=X;q[Y(0x17f)]===o['yJaqy']&&n();});}),!navigator['serviceWorker'][V(0x12a)]){const n=(await navigator[V(0x13a)][V(0x17d)])['active'];n&&(n[V(0x139)]({'type':'SKIP_WAITING'}),await new Promise(o=>{const Z=V;navigator[Z(0x13a)]['addEventListener'](Z(0x155),o,{'once':!0x0});}));}return j;}catch(o){console['error'](V(0x16d),o);}}async['load'](h,j){const a0=B,k={'ovBBW':a0(0x189),'Okyba':function(u,v){return u(v);}};await this['regSW'](),await this[a0(0x141)]();const n=Array['isArray'](h),q=(n?h[0x0]:h)['split']('/')['pop']()['replace'](a0(0x16e),'')||k[a0(0x150)]+Date[a0(0x133)]();if(await this['getGm'](q))return await this['updateLastPlayed'](q),{'url':'/game/'+q+a0(0x15a),'cached':!0x0};j&&k[a0(0x142)](j,!0x0);const r=n?await this['extractMultipleZips'](h):await this['extractZip'](h);return await this[a0(0x169)](q,r),j&&j(!0x1),{'url':'/game/'+q+a0(0x15a),'cached':!0x1};}}export{w as default};